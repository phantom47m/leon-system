/* ════════════════════════════════════════════════════════
   LEON — JARVIS NEURAL INTERFACE  v20
   Hub-centric radial navigation.
   Side panels removed. Glass panels slide out from hub.
   ════════════════════════════════════════════════════════ */

:root {
    --cyan:       #00d4ff;
    --green:      #00ffaa;
    --orange:     #ff7700;
    --purple:     #8888ff;
    --red:        #ff3355;
    --white:      #cce8f4;

    --bg:         #040911;
    --panel-bg:   rgba(4, 16, 32, 0.88);
    --panel-bdr:  rgba(0, 200, 255, 0.25);
    --panel-glow: rgba(0, 180, 255, 0.06);

    --font-hud:   'Orbitron', monospace;
    --font-body:  'Rajdhani', sans-serif;
    --font-mono:  'Courier New', monospace;
    --ease:       cubic-bezier(0.4, 0, 0.2, 1);

    /* Hub visual radius on screen (hub max ~540px → radius ~270px) */
    --hub-r: 270px;
}

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

html, body {
    width: 100%; height: 100%; overflow: hidden;
    background: var(--bg);
    color: var(--white);
    font-family: var(--font-body);
    -webkit-font-smoothing: antialiased;
}

/* ── Stars canvas ─────────────────────────────────── */
#stars-bg { position: fixed; inset: 0; z-index: 0; pointer-events: none; }

/* ── Top bar ──────────────────────────────────────── */
#top-bar {
    position: fixed; top: 0; left: 0; right: 0; height: 40px; z-index: 100;
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 22px;
    background: linear-gradient(180deg, rgba(2,8,20,0.97) 0%, rgba(2,8,20,0.3) 100%);
    border-bottom: 1px solid rgba(0, 180, 255, 0.09);
}

.logo { display: flex; align-items: center; gap: 8px; }
.logo-hex {
    color: var(--cyan); font-size: 13px;
    filter: drop-shadow(0 0 8px rgba(0,212,255,0.9));
    animation: hexPulse 3s ease-in-out infinite;
}
@keyframes hexPulse { 0%,100%{opacity:1;} 50%{opacity:0.45;} }
.logo-text {
    font-family: var(--font-hud); font-size: 16px; font-weight: 900;
    color: var(--cyan); letter-spacing: 10px;
    text-shadow: 0 0 22px rgba(0,212,255,0.65);
}
.logo-ver {
    font-family: var(--font-hud); font-size: 8px;
    color: rgba(0,212,255,0.28); letter-spacing: 2px; margin-top: 3px;
}

.top-stats { display: flex; align-items: center; gap: 8px; }
.stat-chip { display: flex; align-items: center; gap: 5px; font-family: var(--font-hud); font-size: 9px; letter-spacing: 1px; }
.sl { color: rgba(0,212,255,0.35); margin-right: 1px; }
.stat-chip span:last-child { color: var(--cyan); }
.divr { color: rgba(0,180,255,0.12); }

.top-right { display: flex; align-items: center; gap: 14px; }
.voice-chip {
    font-family: var(--font-hud); font-size: 8px; letter-spacing: 2px;
    color: rgba(0,212,255,0.28); padding: 2px 7px;
    border: 1px solid rgba(0,180,255,0.12); border-radius: 2px;
}
.voice-chip.active { color: var(--green); border-color: rgba(0,255,170,0.3); text-shadow: 0 0 8px rgba(0,255,170,0.5); }

/* OpenClaw crab button */
.top-icon-btn {
    background: none; border: 1px solid rgba(0,180,255,0.15); border-radius: 4px;
    font-size: 14px; cursor: pointer; padding: 2px 6px; line-height: 1;
    transition: all 0.2s; opacity: 0.65;
    filter: grayscale(0.3);
}
.top-icon-btn:hover {
    opacity: 1; border-color: var(--cyan);
    box-shadow: 0 0 10px rgba(0,212,255,0.25);
    filter: none;
}

.ws-ind { display: flex; align-items: center; gap: 6px; font-family: var(--font-hud); font-size: 8px; letter-spacing: 2px; color: var(--green); }
.ws-ind.disconnected { color: var(--red); }
.ws-ind.reconnecting { color: var(--orange); }
.ws-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--green); box-shadow: 0 0 8px var(--green); animation: dotBlink 2s ease-in-out infinite; }
.ws-dot.disconnected { background: var(--red); box-shadow: 0 0 6px var(--red); animation: none; }
.ws-dot.reconnecting { background: var(--orange); animation: dotBlink 0.5s infinite; }
@keyframes dotBlink { 0%,100%{opacity:1;} 50%{opacity:0.2;} }

/* ── Hub Universe ─────────────────────────────────── */
#hub-universe {
    position: fixed;
    top: 40px; left: 0; right: 0; bottom: 58px;
    display: flex; align-items: center; justify-content: center;
    z-index: 10;
    /* Panels are absolute children of this */
}

/* ── Central Hub ─────────────────────────────────── */
#hub-container {
    width:  min(540px, 85vh, 85vw);
    height: min(540px, 85vh, 85vw);
    flex-shrink: 0;
    position: relative; z-index: 15;
}
#hub {
    width: 100%; height: 100%;
    filter: drop-shadow(0 0 40px rgba(0,212,255,0.18));
    animation: hubBreath 5s ease-in-out infinite;
}
@keyframes hubBreath {
    0%,100% { filter: drop-shadow(0 0 40px rgba(0,212,255,0.18)); }
    50%      { filter: drop-shadow(0 0 60px rgba(0,212,255,0.30)); }
}
/* MIC visual states on the hub */
#hub.mic-active {
    animation: hubBreathActive 2.5s ease-in-out infinite;
}
#hub.mic-muted {
    animation: hubBreathMuted 5s ease-in-out infinite;
}
@keyframes hubBreathMuted {
    /* Subtle red tint when muted */
    0%,100% { filter: drop-shadow(0 0 38px rgba(0,212,255,0.16)) drop-shadow(0 0 10px rgba(255,30,60,0.08)); }
    50%      { filter: drop-shadow(0 0 55px rgba(0,212,255,0.26)) drop-shadow(0 0 18px rgba(255,30,60,0.14)); }
}
@keyframes hubBreathActive {
    /* Orange glow when mic is live */
    0%,100% { filter: drop-shadow(0 0 38px rgba(255,140,0,0.25)) drop-shadow(0 0 20px rgba(255,140,0,0.1)); }
    50%      { filter: drop-shadow(0 0 60px rgba(255,140,0,0.45)) drop-shadow(0 0 30px rgba(255,140,0,0.2)); }
}

/* ── Hub nav arc hover styles (SVG) ──────────────── */
.nav-arc { transition: opacity 0.25s ease; }

/* ── Floating glass panels ───────────────────────── */
.hub-panel {
    position: absolute;
    z-index: 20;
    padding: 14px 15px;
    background: var(--panel-bg);
    border: 1px solid var(--panel-bdr);
    border-radius: 4px;
    backdrop-filter: blur(18px);
    box-shadow: 0 0 30px var(--panel-glow), 0 8px 32px rgba(0,0,0,0.5);

    /* Hidden by default */
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.35s var(--ease), transform 0.35s var(--ease);

    /* Top highlight line */
    overflow: hidden;
}
.hub-panel::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 1px;
    background: linear-gradient(90deg, transparent, var(--cyan), transparent);
    opacity: 0.4;
}
.hub-panel.open {
    opacity: 1;
    pointer-events: auto;
}

/* SYSTEM — slides in from left */
.panel-left {
    width: 210px;
    right: calc(50% + var(--hub-r) + 18px);
    top: 50%; transform: translateY(-50%) translateX(22px);
    max-height: min(420px, 75vh); overflow-y: auto;
}
.panel-left::after {
    /* Arm connecting to hub */
    content: '';
    position: absolute; top: 50%; right: -18px;
    width: 18px; height: 1px;
    background: linear-gradient(90deg, var(--panel-bdr), transparent);
    transform: translateY(-50%);
}
.panel-left.open { transform: translateY(-50%) translateX(0); }

/* AGENTS — slides in from right */
.panel-right {
    width: 200px;
    left: calc(50% + var(--hub-r) + 18px);
    top: 50%; transform: translateY(-50%) translateX(-22px);
    max-height: min(380px, 75vh); overflow-y: auto;
}
.panel-right::after {
    content: '';
    position: absolute; top: 50%; left: -18px;
    width: 18px; height: 1px;
    background: linear-gradient(270deg, var(--panel-bdr), transparent);
    transform: translateY(-50%);
}
.panel-right.open { transform: translateY(-50%) translateX(0); }

/* FEED — anchored so right edge clears hub left edge by 20px */
.panel-feed-pos {
    width: min(460px, 42vw);
    max-width: calc(50vw - var(--hub-r) - 30px);
    /* Right edge sits just left of the hub circle */
    right: calc(50% + var(--hub-r) + 20px);
    top: calc(50% + var(--hub-r) - 110px);
    max-height: 240px;
    transform: translateX(14px) translateY(8px);
}
.panel-feed-pos::after {
    content: '';
    position: absolute; top: 40px; right: -18px;
    width: 18px; height: 1px;
    background: linear-gradient(90deg, rgba(0,255,170,0.3), transparent);
}
.panel-feed-pos.open { transform: translateX(0) translateY(0); }

/* STATUS — slides up-left from hub top-left area */
.panel-topleft {
    width: 190px;
    right: calc(50% + var(--hub-r) - 60px);
    bottom: calc(50% + var(--hub-r) + 18px);
    transform: translateY(18px);
}
.panel-topleft::after {
    content: '';
    position: absolute; bottom: -18px; right: 40px;
    width: 1px; height: 18px;
    background: linear-gradient(180deg, var(--panel-bdr), transparent);
}
.panel-topleft.open { transform: translateY(0); }

/* ── Panel inner elements ────────────────────────── */
.panel-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 11px; padding-bottom: 6px;
    border-bottom: 1px solid rgba(0,180,255,0.12);
}
.panel-title {
    font-family: var(--font-hud); font-size: 8px; font-weight: 700;
    color: var(--cyan); letter-spacing: 3px;
}
.panel-title-sm {
    font-family: var(--font-hud); font-size: 7px; color: rgba(0,212,255,0.4);
    letter-spacing: 2px; margin-bottom: 5px;
}
.panel-close {
    background: none; border: 1px solid rgba(0,180,255,0.15); border-radius: 2px;
    color: rgba(0,212,255,0.35); font-size: 9px; cursor: pointer;
    padding: 1px 4px; line-height: 1;
    transition: all 0.2s;
}
.panel-close:hover { color: var(--cyan); border-color: var(--cyan); }

.pdiv {
    height: 1px; margin: 9px 0;
    background: linear-gradient(90deg, transparent, rgba(0,180,255,0.18), transparent);
}

/* ── Metric bars ─────────────────────────────────── */
.bar-row { display: flex; align-items: center; gap: 6px; margin-bottom: 8px; }
.bl { font-family: var(--font-hud); font-size: 7px; letter-spacing: 1px; color: rgba(0,212,255,0.4); min-width: 26px; }
.btrack { flex: 1; height: 3px; background: rgba(0,180,255,0.08); border-radius: 2px; overflow: hidden; position: relative; }
.bfill {
    height: 100%; width: 0%; border-radius: 2px;
    transition: width 1.2s var(--ease);
    position: relative;
}
.bfill::after { content: ''; position: absolute; right: 0; top: 0; width: 4px; height: 100%; background: rgba(255,255,255,0.6); border-radius: 2px; }
.cpu  { background: linear-gradient(90deg, #003d55, var(--cyan)); }
.mem  { background: linear-gradient(90deg, #2d0066, #9966ff); }
.gpu  { background: linear-gradient(90deg, #004433, var(--green)); }
.disk { background: linear-gradient(90deg, #552200, var(--orange)); }
.bv { font-family: var(--font-hud); font-size: 8px; font-weight: 700; color: var(--cyan); min-width: 28px; text-align: right; }

/* ── Info rows ───────────────────────────────────── */
.ir { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
.il { font-family: var(--font-hud); font-size: 7px; letter-spacing: 1px; color: rgba(0,212,255,0.3); text-transform: uppercase; }
.iv { font-family: var(--font-hud); font-size: 9px; font-weight: 700; color: var(--cyan); }
.iv.active { color: var(--green); text-shadow: 0 0 8px rgba(0,255,170,0.5); }
.iv.idle   { color: rgba(0,212,255,0.22); }
.iv.sm     { font-size: 8px; display: block; margin-bottom: 3px; color: rgba(0,212,255,0.5); font-weight: 400; }

/* Agent big number */
.agent-big {
    font-family: var(--font-hud); font-size: 40px; font-weight: 900;
    color: var(--cyan); text-align: center; line-height: 1;
    text-shadow: 0 0 24px rgba(0,212,255,0.55);
    margin: 4px 0 10px;
}

/* ── Agent Terminal Panel ───────────────────────────── */
.agents-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-height: 420px;
    overflow-y: auto;
    padding-right: 4px;
    margin-top: 4px;
}

.agent-terminal {
    background: rgba(0,0,0,0.5);
    border: 1px solid rgba(0, 212, 255, 0.2);
    border-radius: 6px;
    overflow: hidden;
    flex-shrink: 0;
}

.agent-terminal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 5px 8px;
    background: rgba(0, 212, 255, 0.08);
    border-bottom: 1px solid rgba(0, 212, 255, 0.15);
}

.agent-terminal-name {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: #00d4ff;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 160px;
}

.agent-terminal-meta {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
}

.agent-terminal-elapsed {
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    color: rgba(255,255,255,0.4);
}

.agent-terminal-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #00ffaa;
    animation: agent-pulse 2s ease-in-out infinite;
    flex-shrink: 0;
}

@keyframes agent-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
}

.agent-terminal-action {
    padding: 4px 8px 3px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    color: #ffaa00;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    border-bottom: 1px solid rgba(255,170,0,0.15);
    background: rgba(255,170,0,0.04);
}

.agent-terminal-body {
    padding: 6px 8px;
    max-height: 120px;
    overflow-y: auto;
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    line-height: 1.5;
    color: rgba(255,255,255,0.75);
    scrollbar-width: none;
}

.agent-terminal-body::-webkit-scrollbar { display: none; }

.agent-terminal-line {
    white-space: pre-wrap;
    word-break: break-all;
}

.agent-terminal-line.dim { color: rgba(255,255,255,0.3); }
.agent-terminal-line.tool { color: #00d4ff; }
.agent-terminal-line.ok   { color: #00ffaa; }
.agent-terminal-line.err  { color: #ff4466; }
.agent-terminal-line.info { color: #ffaa00; }

.agents-empty {
    font-family: 'Share Tech Mono', monospace;
    font-size: 11px;
    color: rgba(255,255,255,0.2);
    text-align: center;
    padding: 20px 0;
    letter-spacing: 0.1em;
}

/* ── Activity feed ───────────────────────────────── */
#activity-feed {
    max-height: 160px; overflow-y: auto;
    padding: 4px 0; scroll-behavior: smooth;
}
.feed-item { font-size: 11px; line-height: 1.6; padding: 1px 4px; border-radius: 2px; word-break: break-word; animation: feedIn 0.18s ease; }
@keyframes feedIn { from{opacity:0;transform:translateY(3px);} to{opacity:1;transform:translateY(0);} }
.feed-item:hover { background: rgba(0,180,255,0.03); }
.feed-time { font-family: var(--font-mono); font-size: 9px; color: rgba(0,212,255,0.22); margin-right: 6px; }
.feed-command  { color: var(--cyan); font-weight: 600; border-left: 2px solid rgba(0,212,255,0.35); padding-left: 6px; }
.feed-response { color: var(--white); padding-left: 10px; border-left: 2px solid rgba(0,212,255,0.08); white-space: pre-wrap; }
.feed-system   { color: rgba(0,212,255,0.28); font-size: 10px; }
.feed-agent-ok { color: var(--green); border-left: 2px solid rgba(0,255,170,0.25); padding-left: 6px; }
.feed-agent-fail { color: var(--red); border-left: 2px solid rgba(255,51,85,0.25); padding-left: 6px; }
.feed-local { color: var(--cyan); }

/* Copy button on feed-response items */
.feed-copy {
    float: right;
    display: none;
    background: none;
    border: 1px solid rgba(0,180,255,0.15);
    border-radius: 2px;
    color: rgba(0,212,255,0.35);
    font-size: 9px; cursor: pointer;
    padding: 0 4px; margin-left: 6px;
    transition: all 0.15s; line-height: 1.6;
}
.feed-item:hover .feed-copy { display: block; }
.feed-copy:hover { color: var(--cyan); border-color: rgba(0,212,255,0.5); }

/* ── Command bar ─────────────────────────────────── */
#cmd-bar {
    position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%);
    width: 520px; max-width: calc(100vw - 40px); height: 42px;
    display: flex; align-items: center; gap: 10px; padding: 0 18px;
    background: rgba(2,10,22,0.95);
    border: 1px solid rgba(0,180,255,0.24);
    border-radius: 21px;
    backdrop-filter: blur(22px);
    box-shadow: 0 0 32px rgba(0,212,255,0.09), 0 4px 24px rgba(0,0,0,0.55);
    z-index: 9000;
    transition: border-color 0.3s var(--ease), box-shadow 0.3s var(--ease);
}
#cmd-bar:focus-within {
    border-color: rgba(0,212,255,0.48);
    box-shadow: 0 0 44px rgba(0,212,255,0.15), inset 0 0 28px rgba(0,212,255,0.03);
}
.cmd-pfx { color: var(--cyan); font-size: 13px; opacity: 0.5; }
#command-input {
    flex: 1; background: transparent; border: none; outline: none;
    color: var(--white); font-family: var(--font-body);
    font-size: 14px; font-weight: 500; caret-color: var(--cyan);
}
#command-input::placeholder { color: rgba(0,212,255,0.2); }
#cmd-send { background: none; border: none; color: var(--cyan); font-size: 15px; cursor: pointer; opacity: 0.4; transition: opacity 0.2s; padding: 0 4px; }
#cmd-send:hover { opacity: 1; }
#ptt-btn { background: none; border: 1px solid rgba(0,212,255,0.2); border-radius: 3px; color: rgba(0,212,255,0.4); font-size: 12px; cursor: pointer; padding: 2px 7px; margin-left: 2px; transition: color 0.2s, border-color 0.2s, text-shadow 0.2s; letter-spacing: 1px; font-family: 'Orbitron', monospace; }
#ptt-btn:hover { color: var(--cyan); border-color: var(--cyan); text-shadow: 0 0 8px var(--cyan); }
#ptt-btn.ptt-active { color: #00ff88; border-color: #00ff88; text-shadow: 0 0 12px #00ff88; }
.cmd-ld { position: absolute; bottom: 0; left: 18px; right: 18px; height: 2px; border-radius: 1px; overflow: hidden; opacity: 0; transition: opacity 0.3s; }
.cmd-ld.active { opacity: 1; }
.cmd-ld::after { content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 30%; background: linear-gradient(90deg, transparent, var(--cyan), transparent); animation: loadSlide 1s ease-in-out infinite; }
@keyframes loadSlide { 0%{transform:translateX(-100%);} 100%{transform:translateX(430%);} }

/* ── Scanlines ───────────────────────────────────── */
.scanlines { position: fixed; inset: 0; z-index: 200; pointer-events: none; background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.01) 2px, rgba(0,0,0,0.01) 4px); }

/* ── Scrollbar ───────────────────────────────────── */
::-webkit-scrollbar { width: 2px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(0,180,255,0.18); border-radius: 1px; }
* { scrollbar-width: thin; scrollbar-color: rgba(0,180,255,0.18) transparent; }

/* ── Accessibility ───────────────────────────────── */
:focus-visible { outline: 2px solid var(--cyan); outline-offset: 2px; }
#command-input:focus-visible, #auth-token-input:focus-visible { outline: none; }

/* ── Responsive ──────────────────────────────────── */
@media (max-width: 900px) {
    :root { --hub-r: 200px; }
    #hub-container { width: min(400px, 80vw, 80vh); height: min(400px, 80vw, 80vh); }
    .panel-feed-pos { max-width: calc(50vw - 30px); }
}
@media (max-width: 600px) {
    :root { --hub-r: 130px; }
    #hub-container { width: min(280px, 70vw, 70vh); height: min(280px, 70vw, 70vh); }

    /* Stack panels as full-width overlays on mobile */
    .hub-panel {
        position: fixed !important;
        top: auto !important; bottom: 60px !important;
        left: 8px !important; right: 8px !important;
        width: auto !important; max-width: none !important;
        max-height: 50vh;
        transform: translateY(20px) !important;
        z-index: 50;
    }
    .hub-panel.open { transform: translateY(0) !important; }
    .hub-panel::after { display: none; }

    .panel-feed-pos { max-height: 40vh; }

    #cmd-bar { width: calc(100vw - 16px); bottom: 6px; height: 38px; padding: 0 12px; }
    #command-input { font-size: 13px; }

    /* Compact top bar on mobile */
    #top-bar { padding: 0 10px; height: 36px; }
    .top-stats { gap: 4px; }
    .stat-chip { font-size: 7px; }
    .divr { display: none; }
    .logo-text { font-size: 12px; letter-spacing: 6px; }
    .logo-ver { display: none; }
}

@keyframes fadeInOv { from{opacity:0;} to{opacity:1;} }
#feed-scroll-resume:hover { background: rgba(0,180,255,0.12); color: var(--cyan); }

@media (prefers-reduced-motion: reduce) {
    * { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
    .scanlines { display: none; }
}

/* ── Settings Panel ─────────────────────────────── */
#panel-settings {
    position: fixed; z-index: 200;
    background: var(--panel-bg);
    border: 1px solid rgba(0,212,255,0.18);
    border-radius: 6px;
    box-shadow: 0 0 30px rgba(0,0,0,0.6), 0 0 15px rgba(0,212,255,0.06);
    min-width: 260px;
}
.setting-group { display: flex; flex-direction: column; gap: 6px; }
.setting-label {
    font-family: var(--font-hud); font-size: 9px; letter-spacing: 2px;
    color: var(--cyan); opacity: 0.85;
}
.setting-desc { font-size: 10px; color: rgba(255,255,255,0.35); }
.setting-btn-group { display: flex; gap: 6px; margin-top: 4px; }
.mode-btn {
    flex: 1; padding: 6px 4px; font-size: 10px; cursor: pointer;
    background: rgba(0,212,255,0.04); border: 1px solid rgba(0,212,255,0.15);
    border-radius: 4px; color: rgba(255,255,255,0.5);
    font-family: var(--font-hud); letter-spacing: 1px;
    transition: all 0.2s;
}
.mode-btn:hover { border-color: var(--cyan); color: var(--cyan); }
.mode-btn.active {
    background: rgba(0,212,255,0.12); border-color: var(--cyan);
    color: var(--cyan); box-shadow: 0 0 8px rgba(0,212,255,0.2);
}
